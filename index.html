<!DOCTYPE html>
<html lang="ja" data-theme="day">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SUGOMEMO</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <input type="file" id="editFileInput" accept="audio/*,video/*" hidden>
  <input type="file" id="imageFileInput" accept="image/*" multiple hidden>

  <header class="header">
    <div class="header-left">
      <h1 class="logo">SUGOMEMO</h1>
    </div>
    <nav class="tabs">
      <button class="tab active" data-tab="memo">
        <span class="tab-label">MEMO</span>
        <span class="tab-indicator"></span>
      </button>
      <button class="tab" data-tab="image">
        <span class="tab-label">IMAGE</span>
        <span class="tab-indicator"></span>
      </button>
      <button class="tab" data-tab="edit">
        <span class="tab-label">CUT</span>
        <span class="tab-indicator"></span>
      </button>
    </nav>
    <div class="header-right">
      <!-- Font Size -->
      <div class="font-size-group">
        <span class="font-size-title">SIZE</span>
        <button class="font-size-opt" data-size="0" id="fontSizeS">S</button>
        <button class="font-size-opt active" data-size="1" id="fontSizeM">M</button>
        <button class="font-size-opt" data-size="2" id="fontSizeL">L</button>
      </div>
      <!-- Theme Toggle Switch -->
      <button class="theme-switch" id="themeToggle" aria-label="Toggle theme">
        <span class="theme-switch-label theme-switch-day">DAY</span>
        <span class="theme-switch-knob"></span>
        <span class="theme-switch-label theme-switch-night">NIGHT</span>
      </button>
    </div>
  </header>

  <main class="main">
    <!-- EDIT Section (Audio + Video unified) -->
    <section class="section" id="section-edit">
      <div class="edit-layout">
        <!-- Upper half: Preview + Drop -->
        <div class="edit-upper">
          <div class="edit-preview" id="editPreview">
            <video id="editVideo" playsinline muted></video>
            <div class="edit-drop-zone" id="editDropZone">
              <span class="drop-plus">+</span>
              <span class="drop-text">音声・動画ファイルをドロップ</span>
            </div>
          </div>
        </div>
        <!-- Lower half: Timeline + Controls -->
        <div class="edit-lower">
          <!-- Timeline area -->
          <div class="edit-timeline-area" id="editTimelineArea">
            <div class="edit-timeline-scroll" id="editTimelineScroll">
              <!-- Time ruler -->
              <div class="edit-ruler" id="editRuler">
                <canvas id="rulerCanvas"></canvas>
                <div class="playhead playhead-ruler" id="editPlayheadRuler"></div>
              </div>
              <!-- Video track -->
              <div class="edit-track" id="editVideoTrack">
                <div class="track-label" id="videoTrackLabel" data-track="video">
                  <span class="track-label-text">V</span>
                  <button class="track-mute-btn" id="videoMuteBtn" title="Vトラック無効">&times;</button>
                </div>
                <div class="track-content" data-track="video">
                  <canvas id="videoTrackCanvas"></canvas>
                  <div class="track-trim-overlay">
                    <div class="trim-dim trim-dim-left" id="videoDimLeft"></div>
                    <div class="trim-dim trim-dim-right" id="videoDimRight"></div>
                  </div>
                </div>
              </div>
              <!-- Audio track -->
              <div class="edit-track" id="editAudioTrack">
                <div class="track-label active" id="audioTrackLabel" data-track="audio">
                  <span class="track-label-text">A</span>
                  <button class="track-mute-btn" id="audioMuteBtn" title="Aトラック無効">&times;</button>
                </div>
                <div class="track-content" data-track="audio">
                  <canvas id="audioTrackCanvas"></canvas>
                  <div class="track-trim-overlay">
                    <div class="trim-dim trim-dim-left" id="audioDimLeft"></div>
                    <div class="trim-dim trim-dim-right" id="audioDimRight"></div>
                    <div class="volume-line" id="volumeLine" data-vol="100%"></div>
                  </div>
                </div>
              </div>
              <!-- Playhead + Trim handles overlay -->
              <div class="edit-timeline-overlay" id="editTimelineOverlay">
                <div class="playhead" id="editPlayhead"></div>
                <div class="trim-handle trim-handle-in" id="trimHandleIn">
                  <div class="trim-grip"></div>
                </div>
                <div class="trim-handle trim-handle-out" id="trimHandleOut">
                  <div class="trim-grip"></div>
                </div>
              </div>
            </div>
          </div>
          <!-- Zoom + Controls bar -->
          <div class="edit-controls-bar">
            <div class="edit-transport">
              <button class="btn btn-icon" id="editPrevFrame" title="1フレーム戻る (←)">&#9664;&#9664;</button>
              <button class="btn btn-circle" id="editPlayBtn" title="再生/停止 (Space)">
                <span class="icon-play"></span>
              </button>
              <button class="btn btn-icon" id="editNextFrame" title="1フレーム進む (→)">&#9654;&#9654;</button>
            </div>
            <div class="edit-time-display">
              <span class="time-track-badge" id="editTrackBadge">A</span>
              <span class="time-label">IN</span>
              <span class="time-value" id="editTimeIn">00:00.000</span>
              <span class="time-label">DUR</span>
              <span class="time-value" id="editTimeDur">00:00.000</span>
              <span class="time-label">OUT</span>
              <span class="time-value" id="editTimeOut">00:00.000</span>
            </div>
            <div class="edit-actions">
              <button class="btn btn-ghost btn-small" id="editMarkIn" title="I = In点">[ I</button>
              <button class="btn btn-ghost btn-small" id="editMarkOut" title="O = Out点">O ]</button>
              <button class="btn btn-icon btn-small" id="editZoomOut" title="縮小 (-)">−</button>
              <span class="zoom-level" id="editZoomLevel">×1</span>
              <button class="btn btn-icon btn-small" id="editZoomIn" title="拡大 (+)">+</button>
              <button class="btn btn-icon btn-small" id="editZoomFit" title="全体表示 (0)">全体</button>
              <button class="btn" id="editExportBtn">書き出し</button>
              <button class="btn btn-ghost btn-small" id="editResetBtn">リセット</button>
            </div>
          </div>
          <div class="shortcut-hints">
            <span><kbd>Space</kbd> 再生</span>
            <span><kbd>←</kbd><kbd>→</kbd> フレーム</span>
            <span><kbd>J</kbd><kbd>L</kbd> 5秒</span>
            <span><kbd>I</kbd> IN</span>
            <span><kbd>O</kbd> OUT</span>
            <span><kbd>Q</kbd><kbd>E</kbd> ズーム</span>
            <span><kbd>Del</kbd> トラック消去</span>
          </div>
          <div class="edit-status" id="editStatus"></div>
        </div>
      </div>
    </section>

    <!-- IMAGE Section -->
    <section class="section" id="section-image">
      <div class="image-drop-zone" id="imageDropZone">
        <span class="drop-plus">+</span>
        <span class="drop-text">画像をドロップ</span>
      </div>
      <div class="image-workspace" id="imageWorkspace" hidden>
        <div class="image-toolbar" id="imageToolbar">
          <!-- Section: 追加 -->
          <div class="toolbar-section">
            <span class="toolbar-section-title">追加</span>
            <div class="toolbar-section-body">
              <button class="btn" id="imageAddBtn" title="画像追加">+ 画像</button>
              <button class="btn" id="imageAddTextBtn" title="テキスト追加">+ 文字</button>
            </div>
          </div>
          <!-- Section: サイズ設定 -->
          <div class="toolbar-section">
            <span class="toolbar-section-title">サイズ設定</span>
            <div class="toolbar-section-body">
              <select class="select" id="canvasSizePreset">
                <option value="custom">カスタム</option>
                <option value="a4">A4 (210x297mm)</option>
                <option value="a3">A3 (297x420mm)</option>
                <option value="b5">B5 (182x257mm)</option>
                <option value="b4">B4 (257x364mm)</option>
                <option value="1920x1080" selected>FHD (1920x1080)</option>
                <option value="3840x2160">4K (3840x2160)</option>
                <option value="1080x1080">正方形 (1080x1080)</option>
                <option value="1080x1350">Instagram (1080x1350)</option>
                <option value="1920x200">バナー横 (1920x200)</option>
                <option value="200x1080">バナー縦 (200x1080)</option>
              </select>
              <select class="select" id="canvasOrientation">
                <option value="landscape">横</option>
                <option value="portrait">縦</option>
              </select>
              <label class="toolbar-label">W</label>
              <input type="number" class="toolbar-input" id="canvasWidthInput" value="1920" min="100" max="8000">
              <label class="toolbar-label">H</label>
              <input type="number" class="toolbar-input" id="canvasHeightInput" value="1080" min="100" max="8000">
              <button class="btn btn-small" id="canvasSizeApply">適用</button>
            </div>
          </div>
          <!-- Section: 背景 -->
          <div class="toolbar-section">
            <span class="toolbar-section-title">背景</span>
            <div class="toolbar-section-body">
              <input type="color" class="toolbar-color" id="canvasBgColor" value="#ffffff">
              <button class="canvas-bg-swatch" data-color="#ffffff" title="白"><span class="bg-swatch-big">W</span><span class="bg-swatch-small">HITE</span></button>
              <button class="canvas-bg-swatch" data-color="#000000" title="黒"><span class="bg-swatch-big">B</span><span class="bg-swatch-small">LACK</span></button>
            </div>
          </div>
          <!-- Section: 描画ツール -->
          <div class="toolbar-section">
            <span class="toolbar-section-title">描画ツール</span>
            <div class="toolbar-section-body">
              <button class="btn tool-btn" id="imagePenBtn" data-tool="pen" title="ペンツール">ペン</button>
              <button class="btn tool-btn" id="imageGaussBtn" data-tool="gauss" title="ぼかしツール">ぼかし</button>
              <button class="btn tool-btn" id="imageMosaicBtn" data-tool="mosaic" title="モザイクツール">モザイク</button>
            </div>
          </div>
          <!-- Section: ペンオプション (動的表示) -->
          <div class="toolbar-section tool-options-section" id="penOptions" hidden>
            <span class="toolbar-section-title">ペン設定</span>
            <div class="toolbar-section-body">
              <label class="toolbar-label">太さ</label>
              <input type="range" class="toolbar-range" id="penSize" min="1" max="60" value="4">
              <span class="toolbar-range-val" id="penSizeVal">4</span>
              <label class="toolbar-label">色</label>
              <input type="color" class="toolbar-color" id="penColor" value="#ff0000">
            </div>
          </div>
          <div class="toolbar-section tool-options-section" id="gaussOptions" hidden>
            <span class="toolbar-section-title">ぼかし設定</span>
            <div class="toolbar-section-body">
              <label class="toolbar-label">太さ</label>
              <input type="range" class="toolbar-range" id="gaussBrushSize" min="5" max="80" value="30">
              <span class="toolbar-range-val" id="gaussBrushSizeVal">30</span>
              <label class="toolbar-label">強さ</label>
              <input type="range" class="toolbar-range" id="gaussEffectSize" min="2" max="40" value="7">
              <span class="toolbar-range-val" id="gaussEffectSizeVal">7</span>
            </div>
          </div>
          <div class="toolbar-section tool-options-section" id="mosaicOptions" hidden>
            <span class="toolbar-section-title">モザイク設定</span>
            <div class="toolbar-section-body">
              <label class="toolbar-label">太さ</label>
              <input type="range" class="toolbar-range" id="mosaicBrushSize" min="5" max="80" value="30">
              <span class="toolbar-range-val" id="mosaicBrushSizeVal">30</span>
              <label class="toolbar-label">粗さ</label>
              <input type="range" class="toolbar-range" id="mosaicEffectSize" min="2" max="40" value="7">
              <span class="toolbar-range-val" id="mosaicEffectSizeVal">7</span>
            </div>
          </div>
          <!-- Section: 書き出し -->
          <div class="toolbar-section">
            <span class="toolbar-section-title">書き出し</span>
            <div class="toolbar-section-body">
              <select class="select" id="imageFormat">
                <option value="png">PNG</option>
                <option value="jpeg">JPG</option>
              </select>
              <button class="btn" id="imageExportBtn">書き出し</button>
              <button class="btn btn-ghost" id="imageResetBtn">リセット</button>
            </div>
          </div>
          <!-- Section: オブジェクト (選択時のみ表示) -->
          <div class="toolbar-section" id="imagePropsBar" hidden>
            <span class="toolbar-section-title">オブジェクト</span>
            <div class="toolbar-section-body">
              <label class="toolbar-label">X</label>
              <input type="number" class="toolbar-input toolbar-input-lg" id="propX" value="0">
              <label class="toolbar-label">Y</label>
              <input type="number" class="toolbar-input toolbar-input-lg" id="propY" value="0">
              <label class="toolbar-label">回転</label>
              <input type="number" class="toolbar-input toolbar-input-lg" id="propRotation" value="0" min="-360" max="360">
              <label class="toolbar-label">倍率%</label>
              <input type="number" class="toolbar-input toolbar-input-lg" id="propScale" value="100" min="1" max="1000">
              <div class="toolbar-separator"></div>
              <button class="btn btn-ghost btn-small" id="propBringFront" title="最前面">▲前</button>
              <button class="btn btn-ghost btn-small" id="propSendBack" title="最背面">▼後</button>
              <div class="toolbar-separator"></div>
              <button class="btn btn-ghost" id="propDeleteBtn">削除</button>
            </div>
          </div>
        </div>
        <div class="image-canvas-area" id="imageCanvasArea">
          <div class="image-canvas-wrapper" id="imageCanvasWrapper">
            <canvas id="imageCanvas"></canvas>
            <div class="image-objects-layer" id="imageObjectsLayer"></div>
            <canvas id="imagePenCanvas"></canvas>
          </div>
        </div>
      </div>
    </section>

    <!-- MEMO Section -->
    <section class="section active" id="section-memo">
      <div class="memo-container">
        <div class="memo-sidebar" id="memoSidebar">
          <div class="memo-sidebar-header">
            <span class="memo-sidebar-title">タグ</span>
            <button class="btn" id="memoTagAddBtn">+</button>
          </div>
          <div class="memo-tag-list" id="memoTagList"></div>
        </div>
        <div class="memo-resize-handle" id="memoResizeHandle"></div>
        <div class="memo-content" id="memoContent">
          <div class="memo-content-header">
            <span class="memo-content-title" id="memoContentTitle">タグを選択</span>
            <div class="memo-content-header-actions">
              <button class="btn btn-ghost" id="memoEditModeBtn" hidden>編集</button>
              <button class="btn" id="memoAddBtn" hidden>+ 追加</button>
            </div>
          </div>
          <div class="memo-item-list" id="memoItemList"></div>
        </div>
      </div>
    </section>
  </main>

  <script src="js/app.js"></script>
  <script src="js/memo.js"></script>
  <script src="js/edit.js"></script>
  <script src="js/image.js"></script>
</body>
</html>
